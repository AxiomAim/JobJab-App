<!-- <button mat-flat-button [matTooltip]="'New User'" [color]="'primary'" (click)="openDrawer()" #selectContact>
    <mat-icon class="icon-size-6" [svgIcon]="'heroicons_outline:user-group'"></mat-icon>
    <span class="text-md">Select Contact</span>
</button> -->

<button class="ml-4" mat-flat-button [color]="'primary'" (click)="openDrawer()" #selectContact>
    <mat-icon [svgIcon]="'heroicons_outline:user-group'"></mat-icon>
    <span class="ml-2 mr-1">Select Contact</span>
</button>


<axiomaim-drawer class="z-999 w-3/4 min-w-3/4 sm:w-3/4 sm:min-w-3/4" fixed [mode]="'over'"
    [name]="'selectContactDrawer'" [position]="'right'" #selectContactDrawer>
    <div class="flex w-full flex-col  mb-8">
        <div class="flex h-10 min-h-10 flex-row items-center bg-sky-900 px-6 text-white py-8">
            <!-- <mat-icon class="text-current icon-size-7" [svgIcon]="'axiomaim:davesa-c'"></mat-icon> -->
            <div class="ml-3 text-2xl font-semibold tracking-tight">
                Select Contact
            </div>
            <button class="ml-auto" mat-icon-button (click)="closeDrawer()">
                <mat-icon class="text-current" [svgIcon]="'heroicons_outline:x-mark'"></mat-icon>
            </button>
        </div>
    </div>
    <div class="absolute inset-0 flex min-w-0 flex-col overflow-hidden mt-10">
        <!-- Main -->
        <div class="flex-auto">
            <!-- Header -->
            <div class="flex flex-auto flex-col justify-between border-b px-6 py-8 sm:flex-row md:flex-col md:px-8">
                <!-- Title -->
                <div>
                    <div class="text-4xl font-extrabold leading-none tracking-tight">
                        Contacts
                    </div>
                    <div class="text-secondary ml-0.5 font-medium">
                        @if (contactCount > 0) {
                        {{ contactCount }}
                        }
                        {{
                        contactCount
                        | i18nPlural
                        : {
                        '=0': 'No contacts',
                        '=1': 'contact',
                        other: 'contacts',
                        }
                        }}
                    </div>
                </div>

                <!-- Main actions -->
                <div class="mt-4 flex items-center sm:mt-0 md:mt-4">
                    <!-- Search -->
                    <div class="flex-auto">
                        <mat-form-field class="axiomaim-mat-dense axiomaim-mat-rounded w-full min-w-50"
                            subscriptSizing="dynamic">
                            <mat-icon class="icon-size-5" matPrefix [svgIcon]="
                                        'heroicons_solid:magnifying-glass'
                                    "></mat-icon>
                            <input matInput [formControl]="searchInputControl" [autocomplete]="'off'"
                                [placeholder]="'Search contacts'" />
                        </mat-form-field>
                    </div>
                </div>
            </div>

            <!-- Users list -->
            <div class="relative">
                @if (contacts$ | async; as contacts) {
                @if (contacts.length) {
                @for (
                contact of contacts;
                track trackByFn(i, contact);
                let i = $index
                ) {
                <!-- Group -->
                <!-- @if (
                    i === 0 ||
                    contact.firstName.charAt(0) !==
                    contacts[i - 1].firstName.charAt(0)
                    ) {
                    <div
                        class="text-secondary sticky top-0 z-10 -mt-px border-b border-t bg-gray-50 px-6 py-1 font-medium uppercase dark:bg-gray-900 md:px-8">
                        {{ contact.firstName.charAt(0) }}
                    </div>
                    } -->
                <!-- User -->
                <a class="z-20 flex cursor-pointer items-center border-b px-6 py-4 md:px-8" [ngClass]="{
                                        'dark:hover:bg-hover hover:bg-gray-100':
                                            !selectedUser ||
                                            selectedUser.id !== contact.id,
                                        'bg-primary-50 dark:bg-hover':
                                            selectedUser &&
                                            selectedUser.id === contact.id,
                                    }" (click)="setContact(contact)">
                    <div class="flex h-10 w-10 flex-0 items-center justify-center overflow-hidden rounded-full">
                        @if (contact.avatar) {
                        <img class="h-full w-full object-cover" [src]="contact.avatar" alt="User avatar" />
                        }
                        @if (!contact.avatar) {
                        <div class="flex h-full w-full items-center justify-center rounded-full  text-lg uppercase text-gray-600 dark:bg-gray-700 dark:text-gray-200"
                            [ngClass]="contact.activeUser ? 'bg-green-200' : 'bg-gray-200'">
                            {{ contact.firstName?.charAt(0) }}{{ contact.lastName?.charAt(0) }}
                        </div>
                        }
                    </div>
                    <div class="ml-4 min-w-0">
                        <div class="truncate font-medium leading-5">
                            {{ contact.firstName }} {{ contact.lastName }}
                        </div>
                        <div class="text-secondary truncate leading-5">
                            {{ contact.emails[0]?.email }}
                        </div>
                    </div>
                </a>
                }
                } @else {
                <div class="border-t p-8 text-center text-4xl font-semibold tracking-tight sm:p-16">
                    There are no contacts!
                </div>
                }
                }

                <!-- No contacts -->
            </div>
        </div>
    </div>
</axiomaim-drawer>