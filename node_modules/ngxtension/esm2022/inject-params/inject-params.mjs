import { inject } from '@angular/core';
import { toSignal } from '@angular/core/rxjs-interop';
import { ActivatedRoute } from '@angular/router';
import { assertInjector } from 'ngxtension/assert-injector';
import { map } from 'rxjs';
/**
 * Injects the params from the current route.
 * If a key is provided, it will return the value of that key.
 * If a transform function is provided, it will return the result of that function.
 * Otherwise, it will return the entire params object.
 *
 * @template T - The expected type of the read value.
 * @param keyOrParamsTransform OPTIONAL The key of the param to return, or a transform function to apply to the params object
 * @param {ParamsOptions} options - Optional configuration options for the parameter.
 * @returns {Signal} A `Signal` that emits the transformed value of the specified parameter, or the entire parameters object if no key is provided.
 *
 * @example
 * const userId = injectParams('id'); // returns the value of the 'id' param
 * const userId = injectParams(p => p['id'] as string); // same as above but can be used with a custom transform function
 * const params = injectParams(); // returns the entire params object
 *
 */
export function injectParams(keyOrParamsTransform, options = {}) {
    return assertInjector(injectParams, options?.injector, () => {
        const route = inject(ActivatedRoute);
        const params = route.snapshot.params;
        const { parse, defaultValue } = options;
        if (!keyOrParamsTransform) {
            return toSignal(route.params, { initialValue: params });
        }
        if (typeof keyOrParamsTransform === 'function') {
            return toSignal(route.params.pipe(map(keyOrParamsTransform)), {
                initialValue: keyOrParamsTransform(params),
            });
        }
        const getParam = (params) => {
            const param = params?.[keyOrParamsTransform];
            if (!param) {
                return defaultValue ?? null;
            }
            return parse ? parse(param) : param;
        };
        return toSignal(route.params.pipe(map(getParam)), {
            initialValue: getParam(params),
        });
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5qZWN0LXBhcmFtcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL2xpYnMvbmd4dGVuc2lvbi9pbmplY3QtcGFyYW1zL3NyYy9pbmplY3QtcGFyYW1zLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQWUsTUFBTSxlQUFlLENBQUM7QUFDcEQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ3RELE9BQU8sRUFBRSxjQUFjLEVBQWUsTUFBTSxpQkFBaUIsQ0FBQztBQUM5RCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFNNUQsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQTREM0I7Ozs7Ozs7Ozs7Ozs7Ozs7R0FnQkc7QUFDSCxNQUFNLFVBQVUsWUFBWSxDQUMzQixvQkFBdUQsRUFDdkQsVUFBdUMsRUFBRTtJQUV6QyxPQUFPLGNBQWMsQ0FBQyxZQUFZLEVBQUUsT0FBTyxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUU7UUFDM0QsTUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQ3JDLE1BQU0sTUFBTSxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDO1FBQ3JDLE1BQU0sRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLEdBQUcsT0FBTyxDQUFDO1FBRXhDLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO1lBQzNCLE9BQU8sUUFBUSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUN6RCxDQUFDO1FBRUQsSUFBSSxPQUFPLG9CQUFvQixLQUFLLFVBQVUsRUFBRSxDQUFDO1lBQ2hELE9BQU8sUUFBUSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLEVBQUU7Z0JBQzdELFlBQVksRUFBRSxvQkFBb0IsQ0FBQyxNQUFNLENBQUM7YUFDMUMsQ0FBQyxDQUFDO1FBQ0osQ0FBQztRQUVELE1BQU0sUUFBUSxHQUFHLENBQUMsTUFBYyxFQUFFLEVBQUU7WUFDbkMsTUFBTSxLQUFLLEdBQUcsTUFBTSxFQUFFLENBQUMsb0JBQW9CLENBQXVCLENBQUM7WUFFbkUsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO2dCQUNaLE9BQU8sWUFBWSxJQUFJLElBQUksQ0FBQztZQUM3QixDQUFDO1lBRUQsT0FBTyxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1FBQ3JDLENBQUMsQ0FBQztRQUVGLE9BQU8sUUFBUSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFO1lBQ2pELFlBQVksRUFBRSxRQUFRLENBQUMsTUFBTSxDQUFDO1NBQzlCLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQyxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGluamVjdCwgdHlwZSBTaWduYWwgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IHRvU2lnbmFsIH0gZnJvbSAnQGFuZ3VsYXIvY29yZS9yeGpzLWludGVyb3AnO1xuaW1wb3J0IHsgQWN0aXZhdGVkUm91dGUsIHR5cGUgUGFyYW1zIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IGFzc2VydEluamVjdG9yIH0gZnJvbSAnbmd4dGVuc2lvbi9hc3NlcnQtaW5qZWN0b3InO1xuaW1wb3J0IHtcblx0RGVmYXVsdFZhbHVlT3B0aW9ucyxcblx0SW5qZWN0b3JPcHRpb25zLFxuXHRQYXJzZU9wdGlvbnMsXG59IGZyb20gJ25neHRlbnNpb24vc2hhcmVkJztcbmltcG9ydCB7IG1hcCB9IGZyb20gJ3J4anMnO1xuXG50eXBlIFBhcmFtc1RyYW5zZm9ybUZuPFJlYWRUPiA9IChwYXJhbXM6IFBhcmFtcykgPT4gUmVhZFQ7XG5cbi8qKlxuICogVGhlIGBQYXJhbXNPcHRpb25zYCB0eXBlIGRlZmluZXMgb3B0aW9ucyBmb3IgY29uZmlndXJpbmcgdGhlIGJlaGF2aW9yIG9mIHRoZSBgaW5qZWN0UGFyYW1zYCBmdW5jdGlvbi5cbiAqXG4gKiBAdGVtcGxhdGUgUmVhZFQgLSBUaGUgZXhwZWN0ZWQgdHlwZSBvZiB0aGUgcmVhZCB2YWx1ZS5cbiAqIEB0ZW1wbGF0ZSBXcml0ZVQgLSBUaGUgdHlwZSBvZiB0aGUgdmFsdWUgdG8gYmUgd3JpdHRlbi5cbiAqIEB0ZW1wbGF0ZSBEZWZhdWx0VmFsdWVUIC0gVGhlIHR5cGUgb2YgdGhlIGRlZmF1bHQgdmFsdWUuXG4gKi9cbmV4cG9ydCB0eXBlIFBhcmFtc09wdGlvbnM8UmVhZFQsIFdyaXRlVCwgRGVmYXVsdFZhbHVlVD4gPSBQYXJzZU9wdGlvbnM8XG5cdFJlYWRULFxuXHRXcml0ZVRcbj4gJlxuXHREZWZhdWx0VmFsdWVPcHRpb25zPERlZmF1bHRWYWx1ZVQ+ICZcblx0SW5qZWN0b3JPcHRpb25zO1xuXG4vKipcbiAqIFRoZSBgaW5qZWN0UGFyYW1zYCBmdW5jdGlvbiBhbGxvd3MgeW91IHRvIGFjY2VzcyBhbmQgbWFuaXB1bGF0ZSBwYXJhbWV0ZXJzIGZyb20gdGhlIGN1cnJlbnQgcm91dGUuXG4gKlxuICogQHJldHVybnMgQSBgU2lnbmFsYCB0aGF0IGVtaXRzIHRoZSBlbnRpcmUgcGFyYW1ldGVycyBvYmplY3QuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbmplY3RQYXJhbXMoKTogU2lnbmFsPFBhcmFtcz47XG5cbi8qKlxuICogVGhlIGBpbmplY3RQYXJhbXNgIGZ1bmN0aW9uIGFsbG93cyB5b3UgdG8gYWNjZXNzIGFuZCBtYW5pcHVsYXRlIHBhcmFtZXRlcnMgZnJvbSB0aGUgY3VycmVudCByb3V0ZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0gVGhlIG5hbWUgb2YgdGhlIHBhcmFtZXRlciB0byByZXRyaWV2ZS5cbiAqIEByZXR1cm5zIHtTaWduYWx9IEEgYFNpZ25hbGAgdGhhdCBlbWl0cyB0aGUgdmFsdWUgb2YgdGhlIHNwZWNpZmllZCBwYXJhbWV0ZXIsIG9yIGBudWxsYCBpZiBpdCdzIG5vdCBwcmVzZW50LlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5qZWN0UGFyYW1zKGtleTogc3RyaW5nKTogU2lnbmFsPHN0cmluZyB8IG51bGw+O1xuXG4vKipcbiAqIFRoZSBgaW5qZWN0UGFyYW1zYCBmdW5jdGlvbiBhbGxvd3MgeW91IHRvIGFjY2VzcyBhbmQgbWFuaXB1bGF0ZSBwYXJhbWV0ZXJzIGZyb20gdGhlIGN1cnJlbnQgcm91dGUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGtleSAtIFRoZSBuYW1lIG9mIHRoZSBwYXJhbWV0ZXIgdG8gcmV0cmlldmUuXG4gKiBAcGFyYW0ge1BhcmFtc09wdGlvbnN9IG9wdGlvbnMgLSBPcHRpb25hbCBjb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHRoZSBwYXJhbWV0ZXIuXG4gKiBAcmV0dXJucyB7U2lnbmFsfSBBIGBTaWduYWxgIHRoYXQgZW1pdHMgdGhlIHRyYW5zZm9ybWVkIHZhbHVlIG9mIHRoZSBzcGVjaWZpZWQgcGFyYW1ldGVyLCBvciBgbnVsbGAgaWYgaXQncyBub3QgcHJlc2VudC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluamVjdFBhcmFtczxSZWFkVD4oXG5cdGtleT86IHN0cmluZyxcblx0b3B0aW9ucz86IFBhcmFtc09wdGlvbnM8UmVhZFQsIHN0cmluZywgUmVhZFQ+LFxuKTogU2lnbmFsPFJlYWRUIHwgbnVsbD47XG5cbi8qKlxuICogVGhlIGBpbmplY3RQYXJhbXNgIGZ1bmN0aW9uIGFsbG93cyB5b3UgdG8gYWNjZXNzIGFuZCBtYW5pcHVsYXRlIHBhcmFtZXRlcnMgZnJvbSB0aGUgY3VycmVudCByb3V0ZS5cbiAqIEl0IHJldHJpZXZlcyB0aGUgdmFsdWUgb2YgYSBwYXJhbWV0ZXIgYmFzZWQgb24gYSBjdXN0b20gdHJhbnNmb3JtIGZ1bmN0aW9uIGFwcGxpZWQgdG8gdGhlIHBhcmFtZXRlcnMgb2JqZWN0LlxuICpcbiAqIEB0ZW1wbGF0ZSBSZWFkVCAtIFRoZSBleHBlY3RlZCB0eXBlIG9mIHRoZSByZWFkIHZhbHVlLlxuICogQHBhcmFtIHtQYXJhbXNUcmFuc2Zvcm1GbjxSZWFkVD59IGZuIC0gQSB0cmFuc2Zvcm0gZnVuY3Rpb24gdGhhdCB0YWtlcyB0aGUgcGFyYW1ldGVycyBvYmplY3QgKGBwYXJhbXM6IFBhcmFtc2ApIGFuZCByZXR1cm5zIHRoZSBkZXNpcmVkIHZhbHVlLlxuICogQHJldHVybnMge1NpZ25hbH0gQSBgU2lnbmFsYCB0aGF0IGVtaXRzIHRoZSB0cmFuc2Zvcm1lZCB2YWx1ZSBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgY3VzdG9tIHRyYW5zZm9ybSBmdW5jdGlvbi5cbiAqXG4gKiBAZXhhbXBsZVxuICogY29uc3Qgc2VhcmNoVmFsdWUgPSBpbmplY3RQYXJhbXMoKHBhcmFtcykgPT4gcGFyYW1zWydzZWFyY2gnXSBhcyBzdHJpbmcpO1xuICovXG5leHBvcnQgZnVuY3Rpb24gaW5qZWN0UGFyYW1zPFJlYWRUPihcblx0Zm46IFBhcmFtc1RyYW5zZm9ybUZuPFJlYWRUPixcbik6IFNpZ25hbDxSZWFkVD47XG5cbi8qKlxuICogSW5qZWN0cyB0aGUgcGFyYW1zIGZyb20gdGhlIGN1cnJlbnQgcm91dGUuXG4gKiBJZiBhIGtleSBpcyBwcm92aWRlZCwgaXQgd2lsbCByZXR1cm4gdGhlIHZhbHVlIG9mIHRoYXQga2V5LlxuICogSWYgYSB0cmFuc2Zvcm0gZnVuY3Rpb24gaXMgcHJvdmlkZWQsIGl0IHdpbGwgcmV0dXJuIHRoZSByZXN1bHQgb2YgdGhhdCBmdW5jdGlvbi5cbiAqIE90aGVyd2lzZSwgaXQgd2lsbCByZXR1cm4gdGhlIGVudGlyZSBwYXJhbXMgb2JqZWN0LlxuICpcbiAqIEB0ZW1wbGF0ZSBUIC0gVGhlIGV4cGVjdGVkIHR5cGUgb2YgdGhlIHJlYWQgdmFsdWUuXG4gKiBAcGFyYW0ga2V5T3JQYXJhbXNUcmFuc2Zvcm0gT1BUSU9OQUwgVGhlIGtleSBvZiB0aGUgcGFyYW0gdG8gcmV0dXJuLCBvciBhIHRyYW5zZm9ybSBmdW5jdGlvbiB0byBhcHBseSB0byB0aGUgcGFyYW1zIG9iamVjdFxuICogQHBhcmFtIHtQYXJhbXNPcHRpb25zfSBvcHRpb25zIC0gT3B0aW9uYWwgY29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB0aGUgcGFyYW1ldGVyLlxuICogQHJldHVybnMge1NpZ25hbH0gQSBgU2lnbmFsYCB0aGF0IGVtaXRzIHRoZSB0cmFuc2Zvcm1lZCB2YWx1ZSBvZiB0aGUgc3BlY2lmaWVkIHBhcmFtZXRlciwgb3IgdGhlIGVudGlyZSBwYXJhbWV0ZXJzIG9iamVjdCBpZiBubyBrZXkgaXMgcHJvdmlkZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGNvbnN0IHVzZXJJZCA9IGluamVjdFBhcmFtcygnaWQnKTsgLy8gcmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlICdpZCcgcGFyYW1cbiAqIGNvbnN0IHVzZXJJZCA9IGluamVjdFBhcmFtcyhwID0+IHBbJ2lkJ10gYXMgc3RyaW5nKTsgLy8gc2FtZSBhcyBhYm92ZSBidXQgY2FuIGJlIHVzZWQgd2l0aCBhIGN1c3RvbSB0cmFuc2Zvcm0gZnVuY3Rpb25cbiAqIGNvbnN0IHBhcmFtcyA9IGluamVjdFBhcmFtcygpOyAvLyByZXR1cm5zIHRoZSBlbnRpcmUgcGFyYW1zIG9iamVjdFxuICpcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluamVjdFBhcmFtczxUPihcblx0a2V5T3JQYXJhbXNUcmFuc2Zvcm0/OiBzdHJpbmcgfCAoKHBhcmFtczogUGFyYW1zKSA9PiBUKSxcblx0b3B0aW9uczogUGFyYW1zT3B0aW9uczxULCBzdHJpbmcsIFQ+ID0ge30sXG4pOiBTaWduYWw8VCB8IFBhcmFtcyB8IHN0cmluZyB8IG51bGw+IHtcblx0cmV0dXJuIGFzc2VydEluamVjdG9yKGluamVjdFBhcmFtcywgb3B0aW9ucz8uaW5qZWN0b3IsICgpID0+IHtcblx0XHRjb25zdCByb3V0ZSA9IGluamVjdChBY3RpdmF0ZWRSb3V0ZSk7XG5cdFx0Y29uc3QgcGFyYW1zID0gcm91dGUuc25hcHNob3QucGFyYW1zO1xuXHRcdGNvbnN0IHsgcGFyc2UsIGRlZmF1bHRWYWx1ZSB9ID0gb3B0aW9ucztcblxuXHRcdGlmICgha2V5T3JQYXJhbXNUcmFuc2Zvcm0pIHtcblx0XHRcdHJldHVybiB0b1NpZ25hbChyb3V0ZS5wYXJhbXMsIHsgaW5pdGlhbFZhbHVlOiBwYXJhbXMgfSk7XG5cdFx0fVxuXG5cdFx0aWYgKHR5cGVvZiBrZXlPclBhcmFtc1RyYW5zZm9ybSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0cmV0dXJuIHRvU2lnbmFsKHJvdXRlLnBhcmFtcy5waXBlKG1hcChrZXlPclBhcmFtc1RyYW5zZm9ybSkpLCB7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZToga2V5T3JQYXJhbXNUcmFuc2Zvcm0ocGFyYW1zKSxcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdGNvbnN0IGdldFBhcmFtID0gKHBhcmFtczogUGFyYW1zKSA9PiB7XG5cdFx0XHRjb25zdCBwYXJhbSA9IHBhcmFtcz8uW2tleU9yUGFyYW1zVHJhbnNmb3JtXSBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XG5cblx0XHRcdGlmICghcGFyYW0pIHtcblx0XHRcdFx0cmV0dXJuIGRlZmF1bHRWYWx1ZSA/PyBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gcGFyc2UgPyBwYXJzZShwYXJhbSkgOiBwYXJhbTtcblx0XHR9O1xuXG5cdFx0cmV0dXJuIHRvU2lnbmFsKHJvdXRlLnBhcmFtcy5waXBlKG1hcChnZXRQYXJhbSkpLCB7XG5cdFx0XHRpbml0aWFsVmFsdWU6IGdldFBhcmFtKHBhcmFtcyksXG5cdFx0fSk7XG5cdH0pO1xufVxuIl19